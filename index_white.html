<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">

    <title>Link Store</title>
    <style>
        body {
            background-color: #ffffff;
            color: #333333;
        }

        .navbar {
            background-color: #ffffff !important;
            border-bottom: 1px solid #e0e0e0;
        }

        /* ë¡œê³  ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
        .navbar-brand img {
            height: 40px; /* ë¡œê³  ì´ë¯¸ì§€ ë†’ì´ ì„¤ì • */
            width: auto;
            margin-right: 5px;
            display: none; /* ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€ */
        }
        /* ë¡œê³  í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .navbar-brand .logo-text {
            font-size: 1.25rem;
            font-weight: bold;
            color: #333333;
        }

        /* ì‚¬ìš©ì ì •ë³´ ìŠ¤íƒ€ì¼ */
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-left: auto;
        }

        .user-email {
            font-size: 14px;
            color: #666666;
        }

        .logout-btn {
            padding: 6px 12px;
            font-size: 14px;
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .logout-btn:hover {
            background-color: #c82333;
        }

        .auth-buttons {
            margin-left: auto;
            display: flex;
            gap: 10px;
        }

        .auth-buttons a {
            padding: 6px 12px;
            font-size: 14px;
            text-decoration: none;
            border-radius: 4px;
            border: 1px solid #007bff;
            color: #007bff;
            transition: all 0.3s;
        }

        .auth-buttons a:first-child {
            background-color: #ffffff;
        }

        .auth-buttons a:first-child:hover {
            background-color: #007bff;
            color: white;
        }

        .auth-buttons a:last-child {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }

        .auth-buttons a:last-child:hover {
            background-color: #218838;
            border-color: #218838;
        }

        .container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 8px;
            margin-top: 30px;
        }

        h1 {
            color: #333333;
            margin-bottom: 20px;
        }

        p {
            color: #666666;
        }

        code {
            background-color: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            color: #d63384;
        }

        ul {
            color: #666666;
        }

        .nav-link {
            color: #333333 !important;
        }

        .nav-link:hover {
            color: #007bff !important;
        }

        #linkForm {
            display: none;
        }

        .form-control {
            background-color: #ffffff;
            color: #333333;
            border: 1px solid #cccccc;
        }

        .form-control:focus {
            background-color: #ffffff;
            color: #333333;
            border-color: #80bdff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        .btn-outline-success {
            color: #28a745;
            border-color: #28a745;
        }

        .btn-outline-success:hover {
            background-color: #28a745;
            color: white;
        }
    </style>
  </head>
  <body>

    <nav class="navbar navbar-expand-lg navbar-light">
      <!-- ë¡œê³  ì˜ì—­ -->
      <a class="navbar-brand" href="#">
          <img id="logoImage" src="" alt="ì‚¬ì´íŠ¸ ë¡œê³ ">
          <span id="logoText" class="logo-text">Link Store</span>
      </a>
      
      <!-- ë°”ë¡œê°€ê¸° ë§í¬ê°€ ì¶”ê°€ë  ì˜ì—­ -->
      <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav mr-auto" id="shortcutLinks">
              <!-- ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë§í¬ê°€ ì¶”ê°€ë©ë‹ˆë‹¤. -->
          </ul>
      </div>
      
      <!-- ì‚¬ìš©ì ì •ë³´ ë° ì¸ì¦ ë²„íŠ¼ -->
      <div id="userInfo" class="user-info" style="display: none;">
          <span class="user-email" id="userEmail"></span>
          <button class="logout-btn" onclick="handleLogout()">ë¡œê·¸ì•„ì›ƒ</button>
      </div>

      <div id="authButtons" class="auth-buttons">
          <a href="singin.html">ë¡œê·¸ì¸</a>
          <a href="signup.html">íšŒì›ê°€ì…</a>
      </div>
      
      <!-- ì…ë ¥ í¼ -->
      <form class="form-inline" onsubmit="event.preventDefault(); updateLogoAndAddLink();" id="linkForm">
        <input class="form-control mr-sm-2" type="url" id="logoUrlInput" placeholder="URL (ë¡œê³  ë˜ëŠ” ë§í¬)" aria-label="add">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">add</button>
      </form>
    </nav>

    <div class="container">
        <h1>ğŸ”— Link Store</h1>
        <p id="description">ë¡œê·¸ì¸ í›„ ë§í¬ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        <div id="content">
            <p style="text-align: center; color: #999;">ë¡œê·¸ì¸í•˜ì—¬ ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”.</p>
        </div>
    </div>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";

        // Firebase ì„¤ì • (ì‚¬ìš©ìë‹˜ì˜ í”„ë¡œì íŠ¸)
        const firebaseConfig = {
            apiKey: "AIzaSyAsgO9Zu8p3dCA2EBhqy9kgEfyXZZrxwXM",
            authDomain: "link-store-no-login.firebaseapp.com",
            projectId: "link-store-no-login",
            storageBucket: "link-store-no-login.firebasestorage.app",
            messagingSenderId: "368312230339",
            appId: "1:368312230339:web:fdb745c5a9c67313789d76",
            measurementId: "G-YVEX6VVYJ8"
        };

        // Firebase ì´ˆê¸°í™”
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // ì¸ì¦ ìƒíƒœ ê°ì‹œ
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•œ ìƒíƒœ
                showLoggedInUI(user);
            } else {
                // ì‚¬ìš©ìê°€ ë¡œê·¸ì•„ì›ƒí•œ ìƒíƒœ
                showLoggedOutUI();
            }
        });

        // ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜
        window.handleLogout = async () => {
            try {
                await signOut(auth);
            } catch (error) {
                alert('ë¡œê·¸ì•„ì›ƒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        };

        // ë¡œê·¸ì¸ëœ UI í‘œì‹œ
        function showLoggedInUI(user) {
            document.getElementById('userInfo').style.display = 'flex';
            document.getElementById('authButtons').style.display = 'none';
            document.getElementById('linkForm').style.display = 'flex';
            document.getElementById('userEmail').textContent = user.email;
            document.getElementById('description').textContent = 'ì…ë ¥ì°½ì— URLì„ ì…ë ¥í•˜ê³  "add" ë²„íŠ¼ì„ ëˆŒëŸ¬ ë¡œê³  ë˜ëŠ” ë§í¬ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.';
            document.getElementById('content').innerHTML = `
                <ul>
                    <li>URLì´ ì´ë¯¸ì§€ë¼ë©´ ë¡œê³ ê°€ ë³€ê²½ë©ë‹ˆë‹¤.</li>
                    <li>URLì´ ì›¹ì‚¬ì´íŠ¸ë¼ë©´ ë‚´ë¹„ê²Œì´ì…˜ ë°”ì— ìƒˆ ë°”ë¡œê°€ê¸° ë§í¬ê°€ ì¶”ê°€ë©ë‹ˆë‹¤.</li>
                </ul>
                <p>ë¡œê³  ì˜ˆì‹œ URL: <code>https://picsum.photos/200/40</code></p>
                <p>ë§í¬ ì˜ˆì‹œ URL: <code>https://www.google.com</code></p>
            `;
        }

        // ë¡œê·¸ì•„ì›ƒëœ UI í‘œì‹œ
        function showLoggedOutUI() {
            document.getElementById('userInfo').style.display = 'none';
            document.getElementById('authButtons').style.display = 'flex';
            document.getElementById('linkForm').style.display = 'none';
            document.getElementById('description').textContent = 'ë¡œê·¸ì¸ í›„ ë§í¬ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
            document.getElementById('content').innerHTML = '<p style="text-align: center; color: #999;">ë¡œê·¸ì¸í•˜ì—¬ ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”.</p>';
        }
    </script>

    <script>
        function updateLogoAndAddLink() {
            const urlInput = document.getElementById('logoUrlInput');
            const newUrl = urlInput.value.trim();

            if (!newUrl) {
                alert('URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // 1. ë¡œê³  ì—…ë°ì´íŠ¸ ì‹œë„
            updateLogo(newUrl);

            // 2. ë°”ë¡œê°€ê¸° ë§í¬ ì¶”ê°€
            addShortcutLink(newUrl);

            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            urlInput.value = '';
        }

        function updateLogo(newUrl) {
            const logoImage = document.getElementById('logoImage');
            const logoText = document.getElementById('logoText');
            
            logoImage.src = newUrl;
            logoImage.style.display = 'inline';
            logoText.style.display = 'none';

            // ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬
            logoImage.onerror = function() {
                logoImage.style.display = 'none';
                logoText.style.display = 'inline';
                logoImage.src = '';
            };
        }

        function addShortcutLink(newUrl) {
            const shortcutLinks = document.getElementById('shortcutLinks');
            
            // ë§í¬ ìš”ì†Œ ìƒì„±
            const listItem = document.createElement('li');
            listItem.className = 'nav-item';
            
            const link = document.createElement('a');
            link.className = 'nav-link';
            link.href = newUrl;
            link.target = '_blank'; // ìƒˆ íƒ­ì—ì„œ ì—´ê¸°
            
            // ë§í¬ í…ìŠ¤íŠ¸ëŠ” URLì˜ í˜¸ìŠ¤íŠ¸ ì´ë¦„ìœ¼ë¡œ ì„¤ì •
            try {
                const urlObject = new URL(newUrl);
                let linkText = urlObject.hostname;
                // 'www.' ì œê±°
                if (linkText.startsWith('www.')) {
                    linkText = linkText.substring(4);
                }
                link.textContent = linkText;
            } catch (e) {
                // URL í˜•ì‹ì´ ì•„ë‹ ê²½ìš° ì „ì²´ URLì„ í…ìŠ¤íŠ¸ë¡œ ì‚¬ìš©
                link.textContent = newUrl;
            }

            listItem.appendChild(link);
            shortcutLinks.appendChild(listItem);
        }
    </script>

  </body>
</html>
